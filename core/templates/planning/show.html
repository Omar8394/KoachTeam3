{% extends "layouts/base.html" %}

{% block title %}{% endblock %} 

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}

{% endblock stylesheets %} 
{% block content %}

	<div class="content" id="contenedor">
		<div class="page-inner">
			<div class="page-header">
				<h4 class="page-title">Profiles</h4>
				<ul class="breadcrumbs">
					<li class="nav-home">
						<a href="{% url 'home' %}">
							<i class="flaticon-home"></i>
						</a>
					</li>
					<li class="separator">
						<i class="flaticon-right-arrow"></i>
					</li>
					<li class="nav-item">
						<span>Planning</span>
					</li>
					<li class="separator">
						<i class="flaticon-right-arrow"></i>
					</li>
					<li class="nav-item">
						<a href=".">Profiles</a>
					</li>
				</ul>
			</div>
            {% include 'planning/filtro.html' %}
			<div class="page-category" id="prueba">
                <div class="card">
                    <div class="card-header">
                        <div class="form-row">
                            <div class="form-group d-flex">
                                <h2 class="card-text mt-2">
                                List of profiles
                                </h2>

                            </div>
                            <div class="form-group d-flex">
                            
                                <form type="get" action=".">
                                    <button type="get"  class="btn btn-outline-dark border-0"><i class="fas fa-redo-alt"></i></button>
                                </form>

                            </div>
                            <div class="form-group d-flex ml-auto">
                            
                                <a href="{% url 'addProfilage' %}" class="btn btn-success">Add profile <i class="fas fa-plus ml-1"></i></a>

                            </div>

                        </div>
                        
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover table-striped table-borderless text-center">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Name</th>
                                        <th>Description</th>
                                        <th>Branch</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>  
                                    {% for p in plan %}  
                                        <tr>  
                                            <td>{{ p.idperfil }}</td>  
                                            <td>{{ p.deescripcion }}</td>  
                                            <td>{{ p.desc_corta }}</td>  
                                            <td>{{ p.fk_rama }}</td>
                                            <td>  
                                                <a href="{% url 'editProfilage' p.idperfil %}" class="btn btn-icon btn-sm btn-info"><i class="fas fa-edit align-middle mt-1"></i></a>  
                                                <button onclick="eliminar({{p.idperfil}})" class="btn btn-icon btn-sm btn-danger ml-1" ><i class="fas fa-trash-alt"></i></button>
                                            </td>  
                                        </tr>  
                                        {% empty %}
                                            <tr><td colspan="100%"><h2>No matching records found</h2></td></tr> 
                                    {% endfor %} 
                                </tbody>  
                            </table>
                        </div>
                    </div>
                    {% include 'planning/paginas.html' with plan=plan %}    
                </div>           
      		</div>
		</div>
	</div>

    {% include 'planning/mensajes.html' %}   



{% endblock content %}
	
<!-- Specific Page JS goes HERE  planning-->
{% block javascripts %}

    <script>
        
        const eliminar = (id) => {

            alerta(3).then((willDelete) => {

                if(willDelete){

                        $.ajax({
                        type: "POST",
                        url: "{% url 'destroyProfilage' %}",
                        data: {
                            'csrfmiddlewaretoken': '{{ csrf_token }}',
                            'id': id,
                        },
                        dataType: "json",
                        success: function (data) {
                            window.location = "{% url 'showProfilage' %}"
                            
                        },
                        failure: function () {
                            swal("failure");
                        }
                    });

                }
            });
        } 


    </script>

{% endblock javascripts %}