{% extends "layouts/base.html" %}

{% block title %}{% endblock %} 

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}

	<div class="content">
		<div class="page-inner">
			<div class="page-header">
				<h4 class="page-title">Competences</h4>
				<ul class="breadcrumbs">
					<li class="nav-home">
						<a href="{% url 'home' %}">
							<i class="flaticon-home"></i>
						</a>
					</li>
					<li class="separator">
						<i class="flaticon-right-arrow"></i>
					</li>
					<li class="nav-item">
						<span>Planning</span>
					</li>
					<li class="separator">
						<i class="flaticon-right-arrow"></i>
					</li>
					<li class="nav-item">
						<a href=".">Competence</a>
					</li>
				</ul>
			</div>
            {% include 'planning/filtro.html' %}
			<div class="page-category">
           	 	<div class="card">
					<div class="card-header">
                        <div class="form-row">
                            <div class="form-group d-flex">
                                <h2 class="card-text mt-2">
                                    List of competences
                                </h2>
    
                            </div>
                            <div class="form-group d-flex">
                               
                                <form type="get" action=".">
                                    <button type="get"  class="btn btn-outline-dark border-0"><i class="fas fa-redo-alt"></i></button>
                                </form>
    
                            </div>
                            <div class="form-group d-flex ml-auto">
                               
                                <a href="{% url 'addCompetence' %}" class="btn btn-success">Add competence <i class="fas fa-plus ml-1"></i></a>
    
                            </div>

                        </div>
						
					</div>
					<div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover table-striped table-borderless text-center">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Name</th>
                                        <th>Profile</th>
                                        <th>Type</th>
                                        <th>Minimum Level</th>
                                    </tr>
                                </thead>
                                <!-- <tbody>
                                    <tr>
                                        <th scope="row">1</th>
                                        <td>Table cell</td>
                                        <td>
                                            <button type="button" class="btn btn-icon btn-sm btn-info"  data-placement="top" title="Tooltip on top" data-toggle="modal" data-target="#newModal">
                                                <i class="fas fa-edit"></i>
                                           </button>
                                           <button type="button" class="btn btn-icon btn-sm btn-danger ml-1" data-toggle="modal" data-target="#newModal">
                                               <i class="fas fa-trash-alt"></i>
                                           </button>       
                                        </td>
                                      
                                    </tr>
                                </tbody> -->
                                <tbody>  
                                    {% for p in competencia %}  
                                        <tr>  
                                            <td>{{ p.idcompetenciasreq }}</td>  
                                            <td>{{ p.desc_competencia }}</td>  
                                            <td>{{ p.fk_perfil }}</td>  
                                            <td>{{ p.fk_tipo_competencia }}</td>  
                                            <td>{{ p.fk_nivel }}</td>  
                                            <td>  
                                                <a href="{% url 'editCompetence' p.idcompetenciasreq %}" class="btn btn-icon btn-sm btn-info"><i class="fas fa-edit align-middle mt-1"></i></a>  
                                                <button onclick="eliminar({{p.idcompetenciasreq}})" class="btn btn-icon btn-sm btn-danger ml-1" ><i class="fas fa-trash-alt"></i></button>
                                            </td>  
                                        </tr>
                                        {% empty %}
                                            <tr><td colspan="100%"><h2>No matching records found</h2></td></tr> 
                                    {% endfor %}
                                </tbody>  
                            </table>
                        </div>
					</div>
                    {% include 'planning/paginas.html' with plan=competencia %}  
				</div>        
      		</div>
		</div>
	</div>
    {% include 'planning/mensajes.html' %}   

{% endblock content %}
	
<!-- Specific Page JS goes HERE  -->
{% block javascripts %}

<script>


    const eliminar = (id) => {

        alerta(3).then((willDelete) => {

            if(willDelete){

                    $.ajax({
                    type: "POST",
                    url: "{% url 'destroyCompetence' %}",
                    data: {
                        'csrfmiddlewaretoken': '{{ csrf_token }}',
                        'id': id,
                    },
                    dataType: "json",
                    success: function (data) {
                        window.location = "{% url 'showCompetence' %}"
                        
                    },
                    failure: function () {
                        swal("failure");
                    }
                });

            }
        });
    } 

</script>

{% endblock javascripts %}